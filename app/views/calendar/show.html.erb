<div class="app-container">
    <%= render 'shared/navbar' %>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Calendar Page -->
        <div id="calendarPage" class="page">

            <div class="page-header">
                <h1 class="page-title">Calendar</h1>
                <p class="page-subtitle">Your Google Calendar events</p>
            </div>

            <div class="content-area">
                <% if flash[:alert] %>
                    <div class="alert-banner"><%= flash[:alert] %></div>
                <% end %>

                <div class="calendar-container">
                    <div class="calendar-header">
                        <div class="calendar-month"><%= @current_date.strftime("%B %Y") %></div>
                        <div class="calendar-nav">
                            <%# Add .to_s to convert the Date object to a String for the URL %>
                            <%= link_to "‚Üê Previous", calendar_path(date: @current_date.prev_month.to_s) %>
                            <%= link_to "Next ‚Üí", calendar_path(date: @current_date.next_month.to_s) %>
                            <%= link_to "Refresh", calendar_path %>
                        </div>
                    </div>
                    
                    <div class="calendar-content">
                        <% if @events.any? %>
                            <%# Loop through the @events array from the controller %>
                            <% @events.each do |event| %>
                                <%# This is the same HTML structure, now built with ERB %>
                                <div class="event-card">
                                    <h3><%= event[:summary].presence || 'Untitled Event' %></h3>
                                    <p>
                                        üìÖ <%= event[:start].strftime("%d %B %Y") %>
                                        <% unless event[:is_all_day] %>
                                        ‚è∞ <%= event[:start].strftime("%l:%M %p") %> - <%= event[:end].strftime("%l:%M %p") %>
                                        <% else %>
                                        (All day)
                                        <% end %>
                                    </p>
                                </div>
                            <% end %>
                        <% else %>
                            <p>No events found for this month.</p>
                        <% end %>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>